(function(d){var f;"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(f={},define(function(){return f})):f="undefined"!=typeof window?window:d:f=exports;(function(c){if(!d)var d=1E-6;if(!g)var g="undefined"!=typeof Float32Array?Float32Array:Array;if(!f)var f=Math.random;var l={setMatrixArrayType:function(a){g=a}};"undefined"!=typeof c&&(c.glMatrix=l);var s=Math.PI/180;l.toRadian=function(a){return a*s};var p={create:function(){var a=new g(2);return a[0]=
0,a[1]=0,a},clone:function(a){var b=new g(2);return b[0]=a[0],b[1]=a[1],b},fromValues:function(a,b){var e=new g(2);return e[0]=a,e[1]=b,e},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a},set:function(a,b,e){return a[0]=b,a[1]=e,a},add:function(a,b,e){return a[0]=b[0]+e[0],a[1]=b[1]+e[1],a},subtract:function(a,b,e){return a[0]=b[0]-e[0],a[1]=b[1]-e[1],a}};p.sub=p.subtract;p.multiply=function(a,b,e){return a[0]=b[0]*e[0],a[1]=b[1]*e[1],a};p.mul=p.multiply;p.divide=function(a,b,e){return a[0]=b[0]/
e[0],a[1]=b[1]/e[1],a};p.div=p.divide;p.min=function(a,b,e){return a[0]=Math.min(b[0],e[0]),a[1]=Math.min(b[1],e[1]),a};p.max=function(a,b,e){return a[0]=Math.max(b[0],e[0]),a[1]=Math.max(b[1],e[1]),a};p.scale=function(a,b,e){return a[0]=b[0]*e,a[1]=b[1]*e,a};p.scaleAndAdd=function(a,b,e,k){return a[0]=b[0]+e[0]*k,a[1]=b[1]+e[1]*k,a};p.distance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1];return Math.sqrt(e*e+k*k)};p.dist=p.distance;p.squaredDistance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1];return e*
e+k*k};p.sqrDist=p.squaredDistance;p.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*b+a*a)};p.len=p.length;p.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};p.sqrLen=p.squaredLength;p.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a};p.normalize=function(a,b){var e=b[0],k=b[1],e=e*e+k*k;return 0<e&&(e=1/Math.sqrt(e),a[0]=b[0]*e,a[1]=b[1]*e),a};p.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};p.cross=function(a,b,e){b=b[0]*e[1]-b[1]*e[0];return a[0]=a[1]=0,a[2]=b,a};p.lerp=function(a,
b,e,k){var C=b[0];b=b[1];return a[0]=C+k*(e[0]-C),a[1]=b+k*(e[1]-b),a};p.random=function(a,b){b=b||1;var e=2*f()*Math.PI;return a[0]=Math.cos(e)*b,a[1]=Math.sin(e)*b,a};p.transformMat2=function(a,b,e){var k=b[0];b=b[1];return a[0]=e[0]*k+e[2]*b,a[1]=e[1]*k+e[3]*b,a};p.transformMat2d=function(a,b,e){var k=b[0];b=b[1];return a[0]=e[0]*k+e[2]*b+e[4],a[1]=e[1]*k+e[3]*b+e[5],a};p.transformMat3=function(a,b,e){var k=b[0];b=b[1];return a[0]=e[0]*k+e[3]*b+e[6],a[1]=e[1]*k+e[4]*b+e[7],a};p.transformMat4=function(a,
b,e){var k=b[0];b=b[1];return a[0]=e[0]*k+e[4]*b+e[12],a[1]=e[1]*k+e[5]*b+e[13],a};p.forEach=function(){var a=p.create();return function(b,e,k,C,c,d){var h;e||(e=2);k||(k=0);for(C?h=Math.min(C*e+k,b.length):h=b.length;k<h;k+=e)a[0]=b[k],a[1]=b[k+1],c(a,a,d),b[k]=a[0],b[k+1]=a[1];return b}}();p.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};"undefined"!=typeof c&&(c.vec2=p);var m={create:function(){var a=new g(3);return a[0]=0,a[1]=0,a[2]=0,a},clone:function(a){var b=new g(3);return b[0]=a[0],b[1]=
a[1],b[2]=a[2],b},fromValues:function(a,b,e){var k=new g(3);return k[0]=a,k[1]=b,k[2]=e,k},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},set:function(a,b,e,k){return a[0]=b,a[1]=e,a[2]=k,a},add:function(a,b,e){return a[0]=b[0]+e[0],a[1]=b[1]+e[1],a[2]=b[2]+e[2],a},subtract:function(a,b,e){return a[0]=b[0]-e[0],a[1]=b[1]-e[1],a[2]=b[2]-e[2],a}};m.sub=m.subtract;m.multiply=function(a,b,e){return a[0]=b[0]*e[0],a[1]=b[1]*e[1],a[2]=b[2]*e[2],a};m.mul=m.multiply;m.divide=function(a,b,e){return a[0]=
b[0]/e[0],a[1]=b[1]/e[1],a[2]=b[2]/e[2],a};m.div=m.divide;m.min=function(a,b,e){return a[0]=Math.min(b[0],e[0]),a[1]=Math.min(b[1],e[1]),a[2]=Math.min(b[2],e[2]),a};m.max=function(a,b,e){return a[0]=Math.max(b[0],e[0]),a[1]=Math.max(b[1],e[1]),a[2]=Math.max(b[2],e[2]),a};m.scale=function(a,b,e){return a[0]=b[0]*e,a[1]=b[1]*e,a[2]=b[2]*e,a};m.scaleAndAdd=function(a,b,e,k){return a[0]=b[0]+e[0]*k,a[1]=b[1]+e[1]*k,a[2]=b[2]+e[2]*k,a};m.distance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1],C=b[2]-a[2];return Math.sqrt(e*
e+k*k+C*C)};m.dist=m.distance;m.squaredDistance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1],C=b[2]-a[2];return e*e+k*k+C*C};m.sqrDist=m.squaredDistance;m.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};m.len=m.length;m.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};m.sqrLen=m.squaredLength;m.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a};m.normalize=function(a,b){var e=b[0],k=b[1],C=b[2],e=e*e+k*k+C*C;return 0<e&&(e=1/Math.sqrt(e),
a[0]=b[0]*e,a[1]=b[1]*e,a[2]=b[2]*e),a};m.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};m.cross=function(a,b,e){var k=b[0],C=b[1];b=b[2];var c=e[0],d=e[1];e=e[2];return a[0]=C*e-b*d,a[1]=b*c-k*e,a[2]=k*d-C*c,a};m.lerp=function(a,b,e,k){var c=b[0],d=b[1];b=b[2];return a[0]=c+k*(e[0]-c),a[1]=d+k*(e[1]-d),a[2]=b+k*(e[2]-b),a};m.random=function(a,b){b=b||1;var e=2*f()*Math.PI,k=2*f()-1,c=Math.sqrt(1-k*k)*b;return a[0]=Math.cos(e)*c,a[1]=Math.sin(e)*c,a[2]=k*b,a};m.transformMat4=function(a,b,
e){var k=b[0],c=b[1];b=b[2];return a[0]=e[0]*k+e[4]*c+e[8]*b+e[12],a[1]=e[1]*k+e[5]*c+e[9]*b+e[13],a[2]=e[2]*k+e[6]*c+e[10]*b+e[14],a};m.transformMat3=function(a,b,e){var k=b[0],c=b[1];b=b[2];return a[0]=k*e[0]+c*e[3]+b*e[6],a[1]=k*e[1]+c*e[4]+b*e[7],a[2]=k*e[2]+c*e[5]+b*e[8],a};m.transformQuat=function(a,b,e){var k=b[0],c=b[1],d=b[2];b=e[0];var h=e[1],g=e[2];e=e[3];var f=e*k+h*d-g*c,n=e*c+g*k-b*d,x=e*d+b*c-h*k,k=-b*k-h*c-g*d;return a[0]=f*e+k*-b+n*-g-x*-h,a[1]=n*e+k*-h+x*-b-f*-g,a[2]=x*e+k*-g+f*
-h-n*-b,a};m.rotateX=function(a,b,e,k){var c=[],d=[];return c[0]=b[0]-e[0],c[1]=b[1]-e[1],c[2]=b[2]-e[2],d[0]=c[0],d[1]=c[1]*Math.cos(k)-c[2]*Math.sin(k),d[2]=c[1]*Math.sin(k)+c[2]*Math.cos(k),a[0]=d[0]+e[0],a[1]=d[1]+e[1],a[2]=d[2]+e[2],a};m.rotateY=function(a,b,e,k){var c=[],d=[];return c[0]=b[0]-e[0],c[1]=b[1]-e[1],c[2]=b[2]-e[2],d[0]=c[2]*Math.sin(k)+c[0]*Math.cos(k),d[1]=c[1],d[2]=c[2]*Math.cos(k)-c[0]*Math.sin(k),a[0]=d[0]+e[0],a[1]=d[1]+e[1],a[2]=d[2]+e[2],a};m.rotateZ=function(a,b,e,k){var c=
[],d=[];return c[0]=b[0]-e[0],c[1]=b[1]-e[1],c[2]=b[2]-e[2],d[0]=c[0]*Math.cos(k)-c[1]*Math.sin(k),d[1]=c[0]*Math.sin(k)+c[1]*Math.cos(k),d[2]=c[2],a[0]=d[0]+e[0],a[1]=d[1]+e[1],a[2]=d[2]+e[2],a};m.forEach=function(){var a=m.create();return function(b,e,k,c,d,h){var g;e||(e=3);k||(k=0);for(c?g=Math.min(c*e+k,b.length):g=b.length;k<g;k+=e)a[0]=b[k],a[1]=b[k+1],a[2]=b[k+2],d(a,a,h),b[k]=a[0],b[k+1]=a[1],b[k+2]=a[2];return b}}();m.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};"undefined"!=
typeof c&&(c.vec3=m);var q={create:function(){var a=new g(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},clone:function(a){var b=new g(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},fromValues:function(a,b,e,k){var c=new g(4);return c[0]=a,c[1]=b,c[2]=e,c[3]=k,c},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},set:function(a,b,e,k,c){return a[0]=b,a[1]=e,a[2]=k,a[3]=c,a},add:function(a,b,e){return a[0]=b[0]+e[0],a[1]=b[1]+e[1],a[2]=b[2]+e[2],a[3]=b[3]+e[3],a},subtract:function(a,
b,e){return a[0]=b[0]-e[0],a[1]=b[1]-e[1],a[2]=b[2]-e[2],a[3]=b[3]-e[3],a}};q.sub=q.subtract;q.multiply=function(a,b,e){return a[0]=b[0]*e[0],a[1]=b[1]*e[1],a[2]=b[2]*e[2],a[3]=b[3]*e[3],a};q.mul=q.multiply;q.divide=function(a,b,e){return a[0]=b[0]/e[0],a[1]=b[1]/e[1],a[2]=b[2]/e[2],a[3]=b[3]/e[3],a};q.div=q.divide;q.min=function(a,b,e){return a[0]=Math.min(b[0],e[0]),a[1]=Math.min(b[1],e[1]),a[2]=Math.min(b[2],e[2]),a[3]=Math.min(b[3],e[3]),a};q.max=function(a,b,e){return a[0]=Math.max(b[0],e[0]),
a[1]=Math.max(b[1],e[1]),a[2]=Math.max(b[2],e[2]),a[3]=Math.max(b[3],e[3]),a};q.scale=function(a,b,e){return a[0]=b[0]*e,a[1]=b[1]*e,a[2]=b[2]*e,a[3]=b[3]*e,a};q.scaleAndAdd=function(a,b,e,k){return a[0]=b[0]+e[0]*k,a[1]=b[1]+e[1]*k,a[2]=b[2]+e[2]*k,a[3]=b[3]+e[3]*k,a};q.distance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1],c=b[2]-a[2],d=b[3]-a[3];return Math.sqrt(e*e+k*k+c*c+d*d)};q.dist=q.distance;q.squaredDistance=function(a,b){var e=b[0]-a[0],k=b[1]-a[1],c=b[2]-a[2],d=b[3]-a[3];return e*e+k*k+c*
c+d*d};q.sqrDist=q.squaredDistance;q.length=function(a){var b=a[0],e=a[1],k=a[2];a=a[3];return Math.sqrt(b*b+e*e+k*k+a*a)};q.len=q.length;q.squaredLength=function(a){var b=a[0],e=a[1],k=a[2];a=a[3];return b*b+e*e+k*k+a*a};q.sqrLen=q.squaredLength;q.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a};q.normalize=function(a,b){var e=b[0],k=b[1],c=b[2],d=b[3],e=e*e+k*k+c*c+d*d;return 0<e&&(e=1/Math.sqrt(e),a[0]=b[0]*e,a[1]=b[1]*e,a[2]=b[2]*e,a[3]=b[3]*e),a};q.dot=function(a,b){return a[0]*
b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};q.lerp=function(a,b,e,k){var c=b[0],d=b[1],h=b[2];b=b[3];return a[0]=c+k*(e[0]-c),a[1]=d+k*(e[1]-d),a[2]=h+k*(e[2]-h),a[3]=b+k*(e[3]-b),a};q.random=function(a,b){return b=b||1,a[0]=f(),a[1]=f(),a[2]=f(),a[3]=f(),q.normalize(a,a),q.scale(a,a,b),a};q.transformMat4=function(a,b,e){var k=b[0],c=b[1],d=b[2];b=b[3];return a[0]=e[0]*k+e[4]*c+e[8]*d+e[12]*b,a[1]=e[1]*k+e[5]*c+e[9]*d+e[13]*b,a[2]=e[2]*k+e[6]*c+e[10]*d+e[14]*b,a[3]=e[3]*k+e[7]*c+e[11]*d+e[15]*b,a};q.transformQuat=
function(a,b,e){var k=b[0],c=b[1],d=b[2];b=e[0];var h=e[1],g=e[2];e=e[3];var f=e*k+h*d-g*c,n=e*c+g*k-b*d,x=e*d+b*c-h*k,k=-b*k-h*c-g*d;return a[0]=f*e+k*-b+n*-g-x*-h,a[1]=n*e+k*-h+x*-b-f*-g,a[2]=x*e+k*-g+f*-h-n*-b,a};q.forEach=function(){var a=q.create();return function(b,e,k,c,d,h){var g;e||(e=4);k||(k=0);for(c?g=Math.min(c*e+k,b.length):g=b.length;k<g;k+=e)a[0]=b[k],a[1]=b[k+1],a[2]=b[k+2],a[3]=b[k+3],d(a,a,h),b[k]=a[0],b[k+1]=a[1],b[k+2]=a[2],b[k+3]=a[3];return b}}();q.str=function(a){return"vec4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof c&&(c.vec4=q);l={create:function(){var a=new g(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},clone:function(a){var b=new g(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},transpose:function(a,b){if(a===b){var e=b[1];a[1]=b[2];a[2]=e}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},invert:function(a,b){var e=
b[0],k=b[1],c=b[2],d=b[3],h=e*d-c*k;return h?(h=1/h,a[0]=d*h,a[1]=-k*h,a[2]=-c*h,a[3]=e*h,a):null},adjoint:function(a,b){var e=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=e,a},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},multiply:function(a,b,e){var k=b[0],c=b[1],d=b[2];b=b[3];var h=e[0],g=e[1],f=e[2];e=e[3];return a[0]=k*h+d*g,a[1]=c*h+b*g,a[2]=k*f+d*e,a[3]=c*f+b*e,a}};l.mul=l.multiply;l.rotate=function(a,b,e){var k=b[0],c=b[1],d=b[2];b=b[3];var h=Math.sin(e);e=Math.cos(e);return a[0]=
k*e+d*h,a[1]=c*e+b*h,a[2]=k*-h+d*e,a[3]=c*-h+b*e,a};l.scale=function(a,b,e){var k=b[1],c=b[2],d=b[3],h=e[0];e=e[1];return a[0]=b[0]*h,a[1]=k*h,a[2]=c*e,a[3]=d*e,a};l.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};l.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2))};l.LDU=function(a,b,e,k){return a[2]=k[2]/k[0],e[0]=k[0],e[1]=k[1],e[3]=k[3]-a[2]*e[1],[a,b,e]};"undefined"!=typeof c&&(c.mat2=l);l={create:function(){var a=new g(6);
return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},clone:function(a){var b=new g(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},invert:function(a,b){var e=b[0],k=b[1],c=b[2],d=b[3],h=b[4],g=b[5],f=e*d-k*c;return f?(f=1/f,a[0]=d*f,a[1]=-k*f,a[2]=-c*f,a[3]=e*f,a[4]=(c*g-d*h)*f,a[5]=(k*h-e*g)*f,a):null},determinant:function(a){return a[0]*
a[3]-a[1]*a[2]},multiply:function(a,b,e){var k=b[0],c=b[1],d=b[2],h=b[3],g=b[4];b=b[5];var f=e[0],n=e[1],x=e[2],v=e[3],l=e[4];e=e[5];return a[0]=k*f+d*n,a[1]=c*f+h*n,a[2]=k*x+d*v,a[3]=c*x+h*v,a[4]=k*l+d*e+g,a[5]=c*l+h*e+b,a}};l.mul=l.multiply;l.rotate=function(a,b,e){var k=b[0],c=b[1],d=b[2],h=b[3],g=b[4];b=b[5];var f=Math.sin(e);e=Math.cos(e);return a[0]=k*e+d*f,a[1]=c*e+h*f,a[2]=k*-f+d*e,a[3]=c*-f+h*e,a[4]=g,a[5]=b,a};l.scale=function(a,b,e){var k=b[1],c=b[2],d=b[3],h=b[4],g=b[5],f=e[0];e=e[1];
return a[0]=b[0]*f,a[1]=k*f,a[2]=c*e,a[3]=d*e,a[4]=h,a[5]=g,a};l.translate=function(a,b,e){var k=b[0],c=b[1],d=b[2],h=b[3],g=b[4];b=b[5];var f=e[0];e=e[1];return a[0]=k,a[1]=c,a[2]=d,a[3]=h,a[4]=k*f+d*e+g,a[5]=c*f+h*e+b,a};l.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};l.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};"undefined"!=typeof c&&(c.mat2d=l);var w={create:function(){var a=
new g(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},fromMat4:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a},clone:function(a){var b=new g(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=
0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},transpose:function(a,b){if(a===b){var e=b[1],k=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=e;a[5]=b[7];a[6]=k;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var e=b[0],k=b[1],c=b[2],d=b[3],h=b[4],g=b[5],f=b[6],n=b[7],x=b[8],v=x*h-g*n,l=-x*d+g*f,t=n*d-h*f,m=e*v+k*l+c*t;return m?(m=1/m,a[0]=v*m,a[1]=(-x*k+c*n)*m,a[2]=(g*k-c*h)*m,a[3]=l*m,a[4]=(x*e-c*f)*m,a[5]=(-g*e+c*d)*m,a[6]=
t*m,a[7]=(-n*e+k*f)*m,a[8]=(h*e-k*d)*m,a):null},adjoint:function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=b[4],f=b[5],n=b[6],l=b[7],x=b[8];return a[0]=g*x-f*l,a[1]=d*l-c*x,a[2]=c*f-d*g,a[3]=f*n-h*x,a[4]=e*x-d*n,a[5]=d*h-e*f,a[6]=h*l-g*n,a[7]=c*n-e*l,a[8]=e*g-c*h,a},determinant:function(a){var b=a[3],e=a[4],c=a[5],d=a[6],h=a[7],g=a[8];return a[0]*(g*e-c*h)+a[1]*(-g*b+c*d)+a[2]*(h*b-e*d)},multiply:function(a,b,e){var c=b[0],d=b[1],h=b[2],g=b[3],f=b[4],n=b[5],l=b[6],x=b[7];b=b[8];var v=e[0],m=e[1],t=e[2],
p=e[3],q=e[4],s=e[5],G=e[6],r=e[7];e=e[8];return a[0]=v*c+m*g+t*l,a[1]=v*d+m*f+t*x,a[2]=v*h+m*n+t*b,a[3]=p*c+q*g+s*l,a[4]=p*d+q*f+s*x,a[5]=p*h+q*n+s*b,a[6]=G*c+r*g+e*l,a[7]=G*d+r*f+e*x,a[8]=G*h+r*n+e*b,a}};w.mul=w.multiply;w.translate=function(a,b,e){var c=b[0],d=b[1],h=b[2],g=b[3],f=b[4],n=b[5],l=b[6],x=b[7];b=b[8];var v=e[0];e=e[1];return a[0]=c,a[1]=d,a[2]=h,a[3]=g,a[4]=f,a[5]=n,a[6]=v*c+e*g+l,a[7]=v*d+e*f+x,a[8]=v*h+e*n+b,a};w.rotate=function(a,b,e){var c=b[0],d=b[1],h=b[2],g=b[3],f=b[4],n=b[5],
l=b[6],x=b[7];b=b[8];var v=Math.sin(e);e=Math.cos(e);return a[0]=e*c+v*g,a[1]=e*d+v*f,a[2]=e*h+v*n,a[3]=e*g-v*c,a[4]=e*f-v*d,a[5]=e*n-v*h,a[6]=l,a[7]=x,a[8]=b,a};w.scale=function(a,b,e){var c=e[0];e=e[1];return a[0]=c*b[0],a[1]=c*b[1],a[2]=c*b[2],a[3]=e*b[3],a[4]=e*b[4],a[5]=e*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a};w.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a};w.fromQuat=function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=e+e,f=c+c,
n=d+d,e=e*g,l=c*g,c=c*f,x=d*g,v=d*f,d=d*n,g=h*g,f=h*f,h=h*n;return a[0]=1-c-d,a[3]=l-h,a[6]=x+f,a[1]=l+h,a[4]=1-e-d,a[7]=v-g,a[2]=x-f,a[5]=v+g,a[8]=1-e-c,a};w.normalFromMat4=function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=b[4],f=b[5],n=b[6],l=b[7],x=b[8],v=b[9],m=b[10],t=b[11],p=b[12],q=b[13],s=b[14],r=b[15],y=e*f-c*g,z=e*n-d*g,L=e*l-h*g,A=c*n-d*f,u=c*l-h*f,w=d*l-h*n,D=x*q-v*p,E=x*s-m*p,x=x*r-t*p,F=v*s-m*q,v=v*r-t*q,m=m*r-t*s;return(t=y*m-z*v+L*F+A*x-u*E+w*D)?(t=1/t,a[0]=(f*m-n*v+l*F)*t,a[1]=(n*x-
g*m-l*E)*t,a[2]=(g*v-f*x+l*D)*t,a[3]=(d*v-c*m-h*F)*t,a[4]=(e*m-d*x+h*E)*t,a[5]=(c*x-e*v-h*D)*t,a[6]=(q*w-s*u+r*A)*t,a[7]=(s*L-p*w-r*z)*t,a[8]=(p*u-q*L+r*y)*t,a):null};w.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};w.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};"undefined"!=typeof c&&
(c.mat3=w);var u={create:function(){var a=new g(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},clone:function(a){var b=new g(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},copy:function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],
a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},identity:function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},transpose:function(a,b){if(a===b){var e=b[1],c=b[2],d=b[3],h=b[6],g=b[7],f=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=e;a[6]=b[9];a[7]=b[13];a[8]=c;a[9]=h;a[11]=b[14];a[12]=d;a[13]=g;a[14]=f}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=
b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},invert:function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=b[4],f=b[5],n=b[6],l=b[7],x=b[8],v=b[9],m=b[10],t=b[11],p=b[12],q=b[13],s=b[14],r=b[15],y=e*f-c*g,z=e*n-d*g,u=e*l-h*g,A=c*n-d*f,w=c*l-h*f,H=d*l-h*n,D=x*q-v*p,E=x*s-m*p,F=x*r-t*p,I=v*s-m*q,J=v*r-t*q,K=m*r-t*s,B=y*K-z*J+u*I+A*F-w*E+H*D;return B?(B=1/B,a[0]=(f*K-n*J+l*I)*B,a[1]=(d*J-c*K-h*I)*B,a[2]=(q*H-s*w+r*A)*B,a[3]=(m*w-v*H-t*A)*
B,a[4]=(n*F-g*K-l*E)*B,a[5]=(e*K-d*F+h*E)*B,a[6]=(s*u-p*H-r*z)*B,a[7]=(x*H-m*u+t*z)*B,a[8]=(g*J-f*F+l*D)*B,a[9]=(c*F-e*J-h*D)*B,a[10]=(p*w-q*u+r*y)*B,a[11]=(v*u-x*w-t*y)*B,a[12]=(f*E-g*I-n*D)*B,a[13]=(e*I-c*E+d*D)*B,a[14]=(q*z-p*A-s*y)*B,a[15]=(x*A-v*z+m*y)*B,a):null},adjoint:function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=b[4],f=b[5],n=b[6],l=b[7],m=b[8],v=b[9],p=b[10],t=b[11],q=b[12],s=b[13],r=b[14],u=b[15];return a[0]=f*(p*u-t*r)-v*(n*u-l*r)+s*(n*t-l*p),a[1]=-(c*(p*u-t*r)-v*(d*u-h*r)+s*(d*t-h*
p)),a[2]=c*(n*u-l*r)-f*(d*u-h*r)+s*(d*l-h*n),a[3]=-(c*(n*t-l*p)-f*(d*t-h*p)+v*(d*l-h*n)),a[4]=-(g*(p*u-t*r)-m*(n*u-l*r)+q*(n*t-l*p)),a[5]=e*(p*u-t*r)-m*(d*u-h*r)+q*(d*t-h*p),a[6]=-(e*(n*u-l*r)-g*(d*u-h*r)+q*(d*l-h*n)),a[7]=e*(n*t-l*p)-g*(d*t-h*p)+m*(d*l-h*n),a[8]=g*(v*u-t*s)-m*(f*u-l*s)+q*(f*t-l*v),a[9]=-(e*(v*u-t*s)-m*(c*u-h*s)+q*(c*t-h*v)),a[10]=e*(f*u-l*s)-g*(c*u-h*s)+q*(c*l-h*f),a[11]=-(e*(f*t-l*v)-g*(c*t-h*v)+m*(c*l-h*f)),a[12]=-(g*(v*r-p*s)-m*(f*r-n*s)+q*(f*p-n*v)),a[13]=e*(v*r-p*s)-m*(c*r-
d*s)+q*(c*p-d*v),a[14]=-(e*(f*r-n*s)-g*(c*r-d*s)+q*(c*n-d*f)),a[15]=e*(f*p-n*v)-g*(c*p-d*v)+m*(c*n-d*f),a},determinant:function(a){var b=a[0],e=a[1],c=a[2],d=a[3],h=a[4],g=a[5],f=a[6],n=a[7],l=a[8],m=a[9],v=a[10],p=a[11],t=a[12],s=a[13],q=a[14];a=a[15];return(b*g-e*h)*(v*a-p*q)-(b*f-c*h)*(m*a-p*s)+(b*n-d*h)*(m*q-v*s)+(e*f-c*g)*(l*a-p*t)-(e*n-d*g)*(l*q-v*t)+(c*n-d*f)*(l*s-m*t)},multiply:function(a,b,e){var c=b[0],d=b[1],h=b[2],g=b[3],f=b[4],n=b[5],l=b[6],m=b[7],v=b[8],p=b[9],t=b[10],s=b[11],q=b[12],
r=b[13],u=b[14];b=b[15];var y=e[0],z=e[1],w=e[2],A=e[3];return a[0]=y*c+z*f+w*v+A*q,a[1]=y*d+z*n+w*p+A*r,a[2]=y*h+z*l+w*t+A*u,a[3]=y*g+z*m+w*s+A*b,y=e[4],z=e[5],w=e[6],A=e[7],a[4]=y*c+z*f+w*v+A*q,a[5]=y*d+z*n+w*p+A*r,a[6]=y*h+z*l+w*t+A*u,a[7]=y*g+z*m+w*s+A*b,y=e[8],z=e[9],w=e[10],A=e[11],a[8]=y*c+z*f+w*v+A*q,a[9]=y*d+z*n+w*p+A*r,a[10]=y*h+z*l+w*t+A*u,a[11]=y*g+z*m+w*s+A*b,y=e[12],z=e[13],w=e[14],A=e[15],a[12]=y*c+z*f+w*v+A*q,a[13]=y*d+z*n+w*p+A*r,a[14]=y*h+z*l+w*t+A*u,a[15]=y*g+z*m+w*s+A*b,a}};u.mul=
u.multiply;u.translate=function(a,b,e){var c=e[0],d=e[1];e=e[2];var h,g,f,n,l,m,p,s,q,r,u,w;return b===a?(a[12]=b[0]*c+b[4]*d+b[8]*e+b[12],a[13]=b[1]*c+b[5]*d+b[9]*e+b[13],a[14]=b[2]*c+b[6]*d+b[10]*e+b[14],a[15]=b[3]*c+b[7]*d+b[11]*e+b[15]):(h=b[0],g=b[1],f=b[2],n=b[3],l=b[4],m=b[5],p=b[6],s=b[7],q=b[8],r=b[9],u=b[10],w=b[11],a[0]=h,a[1]=g,a[2]=f,a[3]=n,a[4]=l,a[5]=m,a[6]=p,a[7]=s,a[8]=q,a[9]=r,a[10]=u,a[11]=w,a[12]=h*c+l*d+q*e+b[12],a[13]=g*c+m*d+r*e+b[13],a[14]=f*c+p*d+u*e+b[14],a[15]=n*c+s*d+w*
e+b[15]),a};u.scale=function(a,b,e){var c=e[0],d=e[1];e=e[2];return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a[4]=b[4]*d,a[5]=b[5]*d,a[6]=b[6]*d,a[7]=b[7]*d,a[8]=b[8]*e,a[9]=b[9]*e,a[10]=b[10]*e,a[11]=b[11]*e,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a};u.rotate=function(a,b,e,c){var g=c[0],f=c[1];c=c[2];var n=Math.sqrt(g*g+f*f+c*c),l,m,p,s,v,q,r,u,w,M,G,y,z,L,A,O,H,D,E,F,I,J,K,B;return Math.abs(n)<d?null:(n=1/n,g*=n,f*=n,c*=n,l=Math.sin(e),m=Math.cos(e),p=1-m,s=b[0],v=b[1],q=b[2],r=
b[3],u=b[4],w=b[5],M=b[6],G=b[7],y=b[8],z=b[9],L=b[10],A=b[11],O=g*g*p+m,H=f*g*p+c*l,D=c*g*p-f*l,E=g*f*p-c*l,F=f*f*p+m,I=c*f*p+g*l,J=g*c*p+f*l,K=f*c*p-g*l,B=c*c*p+m,a[0]=s*O+u*H+y*D,a[1]=v*O+w*H+z*D,a[2]=q*O+M*H+L*D,a[3]=r*O+G*H+A*D,a[4]=s*E+u*F+y*I,a[5]=v*E+w*F+z*I,a[6]=q*E+M*F+L*I,a[7]=r*E+G*F+A*I,a[8]=s*J+u*K+y*B,a[9]=v*J+w*K+z*B,a[10]=q*J+M*K+L*B,a[11]=r*J+G*K+A*B,b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a)};u.rotateX=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var d=b[4],
h=b[5],g=b[6],f=b[7],n=b[8],l=b[9],m=b[10],p=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=d*e+n*c,a[5]=h*e+l*c,a[6]=g*e+m*c,a[7]=f*e+p*c,a[8]=n*e-d*c,a[9]=l*e-h*c,a[10]=m*e-g*c,a[11]=p*e-f*c,a};u.rotateY=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var d=b[0],h=b[1],g=b[2],f=b[3],n=b[8],l=b[9],m=b[10],p=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=d*e-n*c,
a[1]=h*e-l*c,a[2]=g*e-m*c,a[3]=f*e-p*c,a[8]=d*c+n*e,a[9]=h*c+l*e,a[10]=g*c+m*e,a[11]=f*c+p*e,a};u.rotateZ=function(a,b,e){var c=Math.sin(e);e=Math.cos(e);var d=b[0],h=b[1],g=b[2],f=b[3],n=b[4],l=b[5],m=b[6],p=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=d*e+n*c,a[1]=h*e+l*c,a[2]=g*e+m*c,a[3]=f*e+p*c,a[4]=n*e-d*c,a[5]=l*e-h*c,a[6]=m*e-g*c,a[7]=p*e-f*c,a};u.fromRotationTranslation=function(a,b,e){var c=b[0],d=b[1],h=b[2],g=b[3],
f=c+c,n=d+d,l=h+h;b=c*f;var m=c*n,c=c*l,p=d*n,d=d*l,h=h*l,f=g*f,n=g*n,g=g*l;return a[0]=1-(p+h),a[1]=m+g,a[2]=c-n,a[3]=0,a[4]=m-g,a[5]=1-(b+h),a[6]=d+f,a[7]=0,a[8]=c+n,a[9]=d-f,a[10]=1-(b+p),a[11]=0,a[12]=e[0],a[13]=e[1],a[14]=e[2],a[15]=1,a};u.fromQuat=function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=e+e,f=c+c,n=d+d,e=e*g,l=c*g,c=c*f,m=d*g,p=d*f,d=d*n,g=h*g,f=h*f,h=h*n;return a[0]=1-c-d,a[1]=l+h,a[2]=m-f,a[3]=0,a[4]=l-h,a[5]=1-e-d,a[6]=p+g,a[7]=0,a[8]=m+f,a[9]=p-g,a[10]=1-e-c,a[11]=0,a[12]=0,a[13]=
0,a[14]=0,a[15]=1,a};u.frustum=function(a,b,e,c,d,h,g){var f=1/(e-b),n=1/(d-c),l=1/(h-g);return a[0]=2*h*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*h*n,a[6]=0,a[7]=0,a[8]=(e+b)*f,a[9]=(d+c)*n,a[10]=(g+h)*l,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*h*2*l,a[15]=0,a};u.perspective=function(a,b,e,c,d){b=1/Math.tan(b/2);var h=1/(c-d);return a[0]=b/e,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(d+c)*h,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*d*c*h,a[15]=0,a};u.ortho=function(a,b,e,c,d,h,g){var f=1/(b-
e),n=1/(c-d),l=1/(h-g);return a[0]=-2*f,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*n,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*l,a[11]=0,a[12]=(b+e)*f,a[13]=(d+c)*n,a[14]=(g+h)*l,a[15]=1,a};u.lookAt=function(a,b,e,c){var g,f,n,l,m,p,s,q,r,t,w=b[0],N=b[1];b=b[2];var M=c[0],G=c[1];c=c[2];var y=e[0],z=e[1];e=e[2];return Math.abs(w-y)<d&&Math.abs(N-z)<d&&Math.abs(b-e)<d?u.identity(a):(s=w-y,q=N-z,r=b-e,t=1/Math.sqrt(s*s+q*q+r*r),s*=t,q*=t,r*=t,g=G*r-c*q,f=c*s-M*r,n=M*q-G*s,t=Math.sqrt(g*g+f*f+n*n),t?(t=1/t,g*=t,f*=
t,n*=t):(g=0,f=0,n=0),l=q*n-r*f,m=r*g-s*n,p=s*f-q*g,t=Math.sqrt(l*l+m*m+p*p),t?(t=1/t,l*=t,m*=t,p*=t):(l=0,m=0,p=0),a[0]=g,a[1]=l,a[2]=s,a[3]=0,a[4]=f,a[5]=m,a[6]=q,a[7]=0,a[8]=n,a[9]=p,a[10]=r,a[11]=0,a[12]=-(g*w+f*N+n*b),a[13]=-(l*w+m*N+p*b),a[14]=-(s*w+q*N+r*b),a[15]=1,a)};u.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};u.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};"undefined"!=typeof c&&(c.mat4=u);var r={create:function(){var a=new g(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}};r.rotationTo=function(){var a=m.create(),b=m.fromValues(1,0,0),e=m.fromValues(0,1,0);return function(c,d,
h){var g=m.dot(d,h);return-0.999999>g?(m.cross(a,b,d),1E-6>m.length(a)&&m.cross(a,e,d),m.normalize(a,a),r.setAxisAngle(c,a,Math.PI),c):0.999999<g?(c[0]=0,c[1]=0,c[2]=0,c[3]=1,c):(m.cross(a,d,h),c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=1+g,r.normalize(c,c))}}();r.setAxes=function(){var a=w.create();return function(b,e,c,d){return a[0]=c[0],a[3]=c[1],a[6]=c[2],a[1]=d[0],a[4]=d[1],a[7]=d[2],a[2]=-e[0],a[5]=-e[1],a[8]=-e[2],r.normalize(b,r.fromMat3(b,a))}}();r.clone=q.clone;r.fromValues=q.fromValues;r.copy=
q.copy;r.set=q.set;r.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a};r.setAxisAngle=function(a,b,e){e*=0.5;var c=Math.sin(e);return a[0]=c*b[0],a[1]=c*b[1],a[2]=c*b[2],a[3]=Math.cos(e),a};r.add=q.add;r.multiply=function(a,b,e){var c=b[0],d=b[1],h=b[2];b=b[3];var g=e[0],f=e[1],n=e[2];e=e[3];return a[0]=c*e+b*g+d*n-h*f,a[1]=d*e+b*f+h*g-c*n,a[2]=h*e+b*n+c*f-d*g,a[3]=b*e-c*g-d*f-h*n,a};r.mul=r.multiply;r.scale=q.scale;r.rotateX=function(a,b,e){e*=0.5;var c=b[0],d=b[1],h=b[2];b=b[3];var g=Math.sin(e);
e=Math.cos(e);return a[0]=c*e+b*g,a[1]=d*e+h*g,a[2]=h*e-d*g,a[3]=b*e-c*g,a};r.rotateY=function(a,b,e){e*=0.5;var c=b[0],d=b[1],h=b[2];b=b[3];var g=Math.sin(e);e=Math.cos(e);return a[0]=c*e-h*g,a[1]=d*e+b*g,a[2]=h*e+c*g,a[3]=b*e-d*g,a};r.rotateZ=function(a,b,e){e*=0.5;var c=b[0],d=b[1],h=b[2];b=b[3];var g=Math.sin(e);e=Math.cos(e);return a[0]=c*e+d*g,a[1]=d*e-c*g,a[2]=h*e+b*g,a[3]=b*e-h*g,a};r.calculateW=function(a,b){var e=b[0],c=b[1],d=b[2];return a[0]=e,a[1]=c,a[2]=d,a[3]=-Math.sqrt(Math.abs(1-
e*e-c*c-d*d)),a};r.dot=q.dot;r.lerp=q.lerp;r.slerp=function(a,b,e,c){var d=b[0],h=b[1],g=b[2];b=b[3];var f=e[0],n=e[1],l=e[2];e=e[3];var m,p,s,q,r;return p=d*f+h*n+g*l+b*e,0>p&&(p=-p,f=-f,n=-n,l=-l,e=-e),1E-6<1-p?(m=Math.acos(p),s=Math.sin(m),q=Math.sin((1-c)*m)/s,r=Math.sin(c*m)/s):(q=1-c,r=c),a[0]=q*d+r*f,a[1]=q*h+r*n,a[2]=q*g+r*l,a[3]=q*b+r*e,a};r.invert=function(a,b){var e=b[0],c=b[1],d=b[2],h=b[3],g=e*e+c*c+d*d+h*h,g=g?1/g:0;return a[0]=-e*g,a[1]=-c*g,a[2]=-d*g,a[3]=h*g,a};r.conjugate=function(a,
b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a};r.length=q.length;r.len=r.length;r.squaredLength=q.squaredLength;r.sqrLen=r.squaredLength;r.normalize=q.normalize;r.fromMat3=function(a,b){var e=b[0]+b[4]+b[8];if(0<e)e=Math.sqrt(e+1),a[3]=0.5*e,e=0.5/e,a[0]=(b[7]-b[5])*e,a[1]=(b[2]-b[6])*e,a[2]=(b[3]-b[1])*e;else{var c=0;b[4]>b[0]&&(c=1);b[8]>b[3*c+c]&&(c=2);var d=(c+1)%3,h=(c+2)%3,e=Math.sqrt(b[3*c+c]-b[3*d+d]-b[3*h+h]+1);a[c]=0.5*e;e=0.5/e;a[3]=(b[3*h+d]-b[3*d+h])*e;a[d]=(b[3*d+c]+b[3*c+d])*
e;a[h]=(b[3*h+c]+b[3*c+h])*e}return a};r.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};"undefined"!=typeof c&&(c.quat=r)})(f)})(this);bongiovi=window.bongiovi||{};
(function(){SimpleImageLoader=function(){this._imgs={};this._toLoadCount=this._loadedCount=0;this._callbackProgress=this._callback=this._scope=void 0};var d=SimpleImageLoader.prototype;d.load=function(d,c,h,g){this._imgs={};this._loadedCount=0;this._toLoadCount=d.length;this._scope=c;this._callback=h;this._callbackProgress=g;var n=this;for(c=0;c<d.length;c++){h=new Image;h.onload=function(){n._onImageLoaded()};g=d[c];var l=g.split("/"),l=l[l.length-1].split(".")[0];this._imgs[l]=h;h.src=g}};d._onImageLoaded=
function(){this._loadedCount++;if(this._loadedCount==this._toLoadCount)this._callback.call(this._scope,this._imgs);else{var d=this._loadedCount/this._toLoadCount;this._callbackProgress&&this._callbackProgress.call(this._scope,d)}}})();bongiovi.SimpleImageLoader=new SimpleImageLoader;bongiovi.Utils={};
(function(){var d=function(c,d){this._easing=d||0.1;this._targetValue=this._value=c;bongiovi.Scheduler.addEF(this,this._update)},f=d.prototype;f._update=function(){this._checkLimit();this._value+=(this._targetValue-this._value)*this._easing};f.setTo=function(c){this._targetValue=this._value=c};f.add=function(c){this._targetValue+=c};f.limit=function(c,d){this._min=c;this._max=d;this._checkLimit()};f._checkLimit=function(){void 0!=this._min&&this._targetValue<this._min&&(this._targetValue=this._min);
void 0!=this._max&&this._targetValue>this._max&&(this._targetValue=this._max)};f.__defineGetter__("value",function(){return this._value});f.__defineGetter__("targetValue",function(){return this._targetValue});f.__defineSetter__("value",function(c){this._targetValue=c});bongiovi.EaseNumber=d})();bongiovi=window.bongiovi||{};void 0==window.requestAnimFrame&&(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d){window.setTimeout(d,1E3/60)}}());
(function(){var d=function(){this.FRAMERATE=60;this._delayTasks=[];this._nextTasks=[];this._deferTasks=[];this._highTasks=[];this._usurpTask=[];this._enterframeTasks=[];this._idTable=0;requestAnimFrame(this._loop.bind(this))},f=d.prototype;f._loop=function(){requestAnimFrame(this._loop.bind(this));this._process()};f._process=function(){for(var c=0;c<this._enterframeTasks.length;c++){var d=this._enterframeTasks[c];null!=d&&void 0!=d&&d.func.apply(d.scope,d.params)}for(;0<this._highTasks.length;)d=
this._highTasks.pop(),d.func.apply(d.scope,d.params);for(var g=(new Date).getTime(),c=0;c<this._delayTasks.length;c++)d=this._delayTasks[c],g-d.time>d.delay&&(d.func.apply(d.scope,d.params),this._delayTasks.splice(c,1));g=(new Date).getTime();for(c=1E3/this.FRAMERATE;0<this._deferTasks.length;){var d=this._deferTasks.shift(),f=(new Date).getTime();if(f-g<c)d.func.apply(d.scope,d.params);else{this._deferTasks.unshift(d);break}}g=(new Date).getTime();for(c=1E3/this.FRAMERATE;0<this._usurpTask.length;)if(d=
this._usurpTask.shift(),f=(new Date).getTime(),f-g<c)d.func.apply(d.scope,d.params);else break;this._highTasks=this._highTasks.concat(this._nextTasks);this._nextTasks=[];this._usurpTask=[]};f.addEF=function(c,d,g){g=g||[];var f=this._idTable;this._enterframeTasks[f]={scope:c,func:d,params:g};this._idTable++;return f};f.removeEF=function(c){void 0!=this._enterframeTasks[c]&&(this._enterframeTasks[c]=null);return-1};f.delay=function(c,d,g,f){var l=(new Date).getTime();this._delayTasks.push({scope:c,
func:d,params:g,delay:f,time:l})};f.defer=function(c,d,g){this._deferTasks.push({scope:c,func:d,params:g})};f.next=function(c,d,g){this._nextTasks.push({scope:c,func:d,params:g})};f.usurp=function(c,d,g){this._usurpTask.push({scope:c,func:d,params:g})};bongiovi.Scheduler=new d})();bongiovi=window.bongiovi||{};
(function(){var d=null,f=function(){this.aspectRatio=1;this.fieldOfView=45;this.zNear=5;this.zFar=3E3;this.shaderProgram=this.shader=this.gl=this.canvas=null},c=f.prototype;c.init=function(c,d,f,l){this.canvas=c||document.createElement("canvas");c=l||{};c.antialias=!0;this.gl=this.canvas.getContext("experimental-webgl",c);void 0!==d&&void 0!==f?this.setSize(d,f):this.setSize(window.innerWidth,window.innerHeight);this.gl.getParameter(this.gl.SAMPLES);this.gl.getContextAttributes();this.gl.viewport(0,
0,this.gl.viewportWidth,this.gl.viewportHeight);this.gl.enable(this.gl.DEPTH_TEST);this.gl.enable(this.gl.CULL_FACE);this.gl.enable(this.gl.BLEND);this.gl.clearColor(0,0,0,1);this.gl.clearDepth(1);this.matrix=mat4.create();mat4.identity(this.matrix);this.normalMatrix=mat3.create();this.depthTextureExt=this.gl.getExtension("WEBKIT_WEBGL_depth_texture");this.floatTextureExt=this.gl.getExtension("OES_texture_float");this.floatTextureLinearExt=this.gl.getExtension("OES_texture_float_linear");this.enableAlphaBlending()};
c.getGL=function(){return this.gl};c.setShader=function(c){this.shader=c};c.setShaderProgram=function(c){this.shaderProgram=c};c.setViewport=function(c,d,f,l){this.gl.viewport(c,d,f,l)};c.setMatrices=function(c){this.camera=c};c.rotate=function(c){mat4.copy(this.matrix,c);mat4.multiply(this.matrix,this.camera.getMatrix(),this.matrix);mat3.fromMat4(this.normalMatrix,this.matrix);mat3.invert(this.normalMatrix,this.normalMatrix);mat3.transpose(this.normalMatrix,this.normalMatrix)};c.enableAlphaBlending=
function(){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};c.enableAdditiveBlending=function(){this.gl.blendFunc(this.gl.ONE,this.gl.ONE)};c.clear=function(c,d,f,l){this.gl.clearColor(c,d,f,l);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)};c.draw=function(c){function d(c,g,h){void 0==g.cacheAttribLoc&&(g.cacheAttribLoc={});void 0==g.cacheAttribLoc[h]&&(g.cacheAttribLoc[h]=c.getAttribLocation(g,h));return g.cacheAttribLoc[h]}if(this.shaderProgram){this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,
!1,this.camera.projection||this.camera.getMatrix());this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vBufferPos);var f=d(this.gl,this.shaderProgram,"aVertexPosition");this.gl.vertexAttribPointer(f,c.vBufferPos.itemSize,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(f);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.vBufferUV);f=d(this.gl,this.shaderProgram,"aTextureCoord");this.gl.vertexAttribPointer(f,c.vBufferUV.itemSize,this.gl.FLOAT,
!1,0,0);this.gl.enableVertexAttribArray(f);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,c.iBuffer);for(f=0;f<c.extraAttributes.length;f++){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,c.extraAttributes[f].buffer);var l=d(this.gl,this.shaderProgram,c.extraAttributes[f].name);this.gl.vertexAttribPointer(l,c.extraAttributes[f].itemSize,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(l)}c.drawType==this.gl.POINTS?this.gl.drawArrays(c.drawType,0,c.vertexSize):this.gl.drawElements(c.drawType,c.iBuffer.numItems,
this.gl.UNSIGNED_SHORT,0)}else console.warn("Shader program not ready yet")};c.setSize=function(c,d){this._width=c;this._height=d;this.canvas.width=this._width;this.canvas.height=this._height;this.gl.viewportWidth=this._width;this.gl.viewportHeight=this._height;this.gl.viewport(0,0,this._width,this._height);this.aspectRatio=this._width/this._height};c.__defineGetter__("width",function(){return this._width});c.__defineGetter__("height",function(){return this._height});f.getInstance=function(){null==
d&&(d=new f);return d};bongiovi.GL=f.getInstance();bongiovi.GLTool=f.getInstance()})();bongiovi=window.bongiovi||{};
(function(){var d=function(c){void 0==c&&(c=document);this._isRotateZ=0;this.matrix=mat4.create();this.m=mat4.create();this._vZaxis=vec3.clone([0,0,0]);this._zAxis=vec3.clone([0,0,-1]);this.preMouse={x:0,y:0};this.mouse={x:0,y:0};this._isMouseDown=!1;this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._currDiffY=this._currDiffX=this.diffY=this.diffX=this._rotateZMargin=0;this._offset=0.0040;this._easing=0.1;this._slerp=-1;this._isLocked=!1;var d=this;c.addEventListener("mousedown",
function(c){d._onMouseDown(c)});c.addEventListener("touchstart",function(c){d._onMouseDown(c)});c.addEventListener("mouseup",function(c){d._onMouseUp(c)});c.addEventListener("touchend",function(c){d._onMouseUp(c)});c.addEventListener("mousemove",function(c){d._onMouseMove(c)});c.addEventListener("touchmove",function(c){d._onMouseMove(c)})},f=d.prototype;f.inverseControl=function(c){this._isInvert=void 0==c?!0:c};f.lock=function(c){this._isLocked=void 0==c?!0:c};f.getMousePos=function(c){var d;void 0!=
c.changedTouches?(d=c.changedTouches[0].pageX,c=c.changedTouches[0].pageY):(d=c.clientX,c=c.clientY);return{x:d,y:c}};f._onMouseDown=function(c){if(!this._isLocked&&!this._isMouseDown){c=this.getMousePos(c);var d=quat.clone(this._rotation);this._updateRotation(d);this._rotation=d;this._isMouseDown=!0;this._isRotateZ=0;this.preMouse={x:c.x,y:c.y};if(c.y<this._rotateZMargin||c.y>window.innerHeight-this._rotateZMargin)this._isRotateZ=1;else if(c.x<this._rotateZMargin||c.x>window.innerWidth-this._rotateZMargin)this._isRotateZ=
2;this._currDiffY=this.diffY=this._currDiffX=this.diffX=0}};f._onMouseMove=function(c){this._isLocked||(c.touches&&c.preventDefault(),this.mouse=this.getMousePos(c))};f._onMouseUp=function(c){!this._isLocked&&this._isMouseDown&&(this._isMouseDown=!1)};f.setCameraPos=function(c,d){this._easing=d=d||this._easing;if(!(0<this._slerp)){var g=quat.clone(this._rotation);this._updateRotation(g);this._rotation=quat.clone(g);this._currDiffY=this.diffY=this._currDiffX=this.diffX=0;this._isMouseDown=!1;this._isRotateZ=
0;this._targetQuat=quat.clone(c);this._slerp=1}};f.resetQuat=function(){this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._targetQuat=void 0;this._slerp=-1};f.update=function(){mat4.identity(this.m);void 0==this._targetQuat?(quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=0.1*(0-this._slerp),0.0010>this._slerp?(quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],
this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(quat.set(this.tempRotation,0,0,0,0),quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp)));vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation);mat4.fromQuat(this.matrix,this.tempRotation)};f._updateRotation=function(c){this._isMouseDown&&!this._isLocked&&(this.diffX=-(this.mouse.x-this.preMouse.x),this.diffY=this.mouse.y-this.preMouse.y,this._isInvert&&(this.diffX=-this.diffX),this._isInvert&&
(this.diffY=-this.diffY));this._currDiffX+=(this.diffX-this._currDiffX)*this._easing;this._currDiffY+=(this.diffY-this._currDiffY)*this._easing;if(0<this._isRotateZ){if(1==this._isRotateZ)var d=-this._currDiffX*this._offset,d=d*(this.preMouse.y<this._rotateZMargin?-1:1),g=quat.clone([0,0,Math.sin(d),Math.cos(d)]);else d=-this._currDiffY*this._offset,d*=this.preMouse.x<this._rotateZMargin?1:-1,g=quat.clone([0,0,Math.sin(d),Math.cos(d)]);quat.multiply(quat,c,g)}else d=vec3.clone([this._currDiffX,this._currDiffY,
0]),g=vec3.create(),vec3.cross(g,d,this._zAxis),vec3.normalize(g,g),d=vec3.length(d)*this._offset,g=quat.clone([Math.sin(d)*g[0],Math.sin(d)*g[1],Math.sin(d)*g[2],Math.cos(d)]),quat.multiply(c,g,c)};bongiovi.QuatRotation=d})();bongiovi=window.bongiovi||{};
(function(){var d=function(c){void 0==c&&(c=document);this._isRotateZ=0;this.matrix=mat4.create();this.m=mat4.create();this._vZaxis=vec3.clone([0,0,0]);this._zAxis=vec3.clone([0,0,-1]);this.preMouse={x:0,y:0};this.mouse={x:0,y:0};this._isMouseDown=!1;this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._rotateZMargin=80;this._currDiffY=this._currDiffX=this.diffY=this.diffX=0;this._offset=0.0040;this._easing=0.1;this._slerp=-1;this._isLocked=!1;var d=this;c.addEventListener("mousedown",
function(c){d._onMouseDown(c)});c.addEventListener("touchstart",function(c){d._onMouseDown(c)});c.addEventListener("mouseup",function(c){d._onMouseUp(c)});c.addEventListener("touchend",function(c){d._onMouseUp(c)});c.addEventListener("mousemove",function(c){d._onMouseMove(c)});c.addEventListener("touchmove",function(c){d._onMouseMove(c)})},f=d.prototype;f.inverseControl=function(c){this._isInvert=void 0==c?!0:c};f.lock=function(c){this._isLocked=void 0==c?!0:c};f.getMousePos=function(c){var d;void 0!=
c.changedTouches?(d=c.changedTouches[0].pageX,c=c.changedTouches[0].pageY):(d=c.clientX,c=c.clientY);return{x:d,y:c}};f._onMouseDown=function(c){if(!this._isLocked&&!this._isMouseDown){c=this.getMousePos(c);var d=quat.clone(this._rotation);this._updateRotation(d);this._rotation=d;this._isMouseDown=!0;this._isRotateZ=0;this.preMouse={x:c.x,y:c.y};if(c.y<this._rotateZMargin||c.y>window.innerHeight-this._rotateZMargin)this._isRotateZ=1;else if(c.x<this._rotateZMargin||c.x>window.innerWidth-this._rotateZMargin)this._isRotateZ=
2;this._currDiffY=this.diffY=this._currDiffX=this.diffX=0}};f._onMouseMove=function(c){this._isLocked||(c.touches&&c.preventDefault(),this.mouse=this.getMousePos(c))};f._onMouseUp=function(c){!this._isLocked&&this._isMouseDown&&(this._isMouseDown=!1)};f.setCameraPos=function(c,d){this._easing=d=d||this._easing;0<this._slerp&&(quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0);var g=quat.clone(this._rotation);this._updateRotation(g);
this._rotation=quat.clone(g);this._currDiffY=this.diffY=this._currDiffX=this.diffX=0;this._isMouseDown=!1;this._isRotateZ=0;this._targetQuat=quat.clone(c);this._slerp=1};f.resetQuat=function(){this._rotation=quat.clone([0,0,1,0]);this.tempRotation=quat.clone([0,0,0,0]);this._targetQuat=void 0;this._slerp=-1};f.update=function(){mat4.identity(this.m);void 0==this._targetQuat?(quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):
(this._slerp+=0.1*(0-this._slerp),0.0010>this._slerp?(quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(quat.set(this.tempRotation,0,0,0,0),quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp)));vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation);mat4.fromQuat(this.matrix,this.tempRotation)};f._updateRotation=function(c){this._isMouseDown&&!this._isLocked&&(this.diffX=-(this.mouse.x-
this.preMouse.x),this.diffY=this.mouse.y-this.preMouse.y,this._isInvert&&(this.diffX=-this.diffX),this._isInvert&&(this.diffY=-this.diffY));this._currDiffX+=(this.diffX-this._currDiffX)*this._easing;this._currDiffY+=(this.diffY-this._currDiffY)*this._easing;if(0<this._isRotateZ)if(1==this._isRotateZ)var d=-this._currDiffX*this._offset,d=d*(this.preMouse.y<this._rotateZMargin?-1:1),g=quat.clone([0,0,Math.sin(d),Math.cos(d)]);else d=-this._currDiffY*this._offset,d*=this.preMouse.x<this._rotateZMargin?
1:-1,g=quat.clone([0,0,-Math.sin(d),Math.cos(d)]);else d=vec3.clone([this._currDiffX,this._currDiffY,0]),g=vec3.create(),vec3.cross(g,d,this._zAxis),vec3.normalize(g,g),d=vec3.length(d)*this._offset,g=quat.clone([Math.sin(d)*g[0],Math.sin(d)*g[1],Math.sin(d)*g[2],Math.cos(d)]);quat.multiply(c,g,c)};f.__defineGetter__("rotateMargin",function(){return this._rotateZMargin});f.__defineSetter__("rotateMargin",function(c){this._rotateZMargin=c});bongiovi.SceneRotation=d})();(function(){var d=bongiovi.GL,f=function(){this.gl=bongiovi.GLTool.gl;this._children=[];this._init()},c=f.prototype;c._init=function(){this.camera=new bongiovi.SimpleCamera(d.canvas);this.camera.setPerspective(45*Math.PI/180,d.aspectRatio,5,3E3);this.camera.lockRotation();var c=vec3.clone([0,0,500]),g=vec3.create(),f=vec3.clone([0,-1,0]);this.camera.lookAt(c,g,f);this.sceneRotation=new bongiovi.SceneRotation(d.canvas);this.rotationFront=mat4.create();mat4.identity(this.rotationFront);this.cameraOtho=
new bongiovi.Camera;this._initTextures();this._initViews();window.addEventListener("resize",this._onResize.bind(this))};c._initTextures=function(){};c._initViews=function(){};c.loop=function(){this.update();this.render()};c.update=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.sceneRotation.update();d.setViewport(0,0,d.width,d.height);d.setMatrices(this.camera);d.rotate(this.sceneRotation.matrix)};c.resize=function(){this.camera.resize&&this.camera.resize(d.aspectRatio)};
c.render=function(){};c._onResize=function(c){};bongiovi.Scene=f})();bongiovi=window.bongiovi||{};(function(){var d=function(){this.matrix=mat4.create();mat4.identity(this.matrix);this.position=vec3.create()},f=d.prototype;f.lookAt=function(c,d,g){vec3.copy(this.position,c);mat4.identity(this.matrix);mat4.lookAt(this.matrix,c,d,g)};f.getMatrix=function(){return this.matrix};bongiovi.Camera=d})();bongiovi=window.bongiovi||{};
(function(){var d=bongiovi.Camera,f=function(){d.call(this);this.projection=mat4.create();this.mtxFinal=mat4.create()},c=f.prototype=new d;c.setPerspective=function(c,d,f,l){this._fov=c;this._near=f;this._far=l;this._aspect=d;mat4.perspective(this.projection,c,d,f,l)};c.getMatrix=function(){return this.matrix};c.resize=function(c){this._aspect=c;mat4.perspective(this.projection,this._fov,c,this._near,this._far)};c.__defineGetter__("near",function(){return this._near});c.__defineGetter__("far",function(){return this._far});
bongiovi.CameraPerspective=f})();(function(){var d=function(c){this._listenerTarget=c||window;bongiovi.CameraPerspective.call(this);this._isLocked=!1;this._init()},f=d.prototype=new bongiovi.CameraPerspective,c=bongiovi.CameraPerspective.prototype,h=bongiovi.EaseNumber;f._init=function(){this.radius=new h(500);this.position[2]=this.radius.value;this.center=vec3.create();this.up=vec3.clone([0,-1,0]);this.lookAt(this.position,this.center,this.up);this._mouse={};this._preMouse={};this._isMouseDown=!1;this._rx=new h(0);this._rx.limit(-Math.PI/
2,Math.PI/2);this._ry=new h(0);this._preRY=this._preRX=0;this._isInvert=this._isLockRotation=this._isLocked=!1;this._listenerTarget.addEventListener("mousewheel",this._onWheel.bind(this));this._listenerTarget.addEventListener("DOMMouseScroll",this._onWheel.bind(this));this._listenerTarget.addEventListener("mousedown",this._onMouseDown.bind(this));this._listenerTarget.addEventListener("touchstart",this._onMouseDown.bind(this));this._listenerTarget.addEventListener("mousemove",this._onMouseMove.bind(this));
this._listenerTarget.addEventListener("touchmove",this._onMouseMove.bind(this));window.addEventListener("mouseup",this._onMouseUp.bind(this));window.addEventListener("touchend",this._onMouseUp.bind(this))};f.inverseControl=function(c){this._isInvert=void 0==c?!0:c};f.lock=function(c){this._isLocked=void 0==c?!0:c};f.lockRotation=function(c){this._isLockRotation=void 0==c?!0:c};f._onMouseDown=function(c){this._isLockRotation||this._isLocked||(this._isMouseDown=!0,g(c,this._mouse),g(c,this._preMouse),
this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)};f._onMouseMove=function(c){this._isLockRotation||this._isLocked||(g(c,this._mouse),c.touches&&c.preventDefault(),this._isMouseDown&&(c=this._mouse.x-this._preMouse.x,this._isInvert&&(c*=-1),this._ry.value=this._preRY-0.01*c,c=this._mouse.y-this._preMouse.y,this._isInvert&&(c*=-1),this._rx.value=this._preRX-0.01*c,this._rx.targetValue>0.5*Math.PI&&(this._rx.targetValue=Math)))};f._onMouseUp=function(c){this._isLockRotation||this._isLocked||
(this._isMouseDown=!1)};f._onWheel=function(c){if(!this._isLocked){var d=c.wheelDelta;c=c.detail;this.radius.add(5*-(c?d?0<d/c/40*c?1:-1:-c/3:d/120))}};f.getMatrix=function(){this._updateCameraPosition();this.lookAt(this.position,this.center,this.up);return c.getMatrix.call(this)};f._updateCameraPosition=function(){this.position[2]=this.radius.value;this.position[1]=Math.sin(this._rx.value)*this.radius.value;var c=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+
0.5*Math.PI)*c;this.position[2]=Math.sin(this._ry.value+0.5*Math.PI)*c};var g=function(c,d){var g=d||{};c.touches?(g.x=c.touches[0].pageX,g.y=c.touches[0].pageY):(g.x=c.clientX,g.y=c.clientY);return g};f.__defineGetter__("rx",function(){return this._rx.targetValue});f.__defineSetter__("rx",function(c){this._rx.value=c});f.__defineGetter__("ry",function(){return this._ry.targetValue});f.__defineSetter__("ry",function(c){this._ry.value=c});bongiovi.SimpleCamera=d})();(function(){var d=function(c,d,f){this._vertexA=c;this._vertexB=d;this._vertexC=f;this._init()},f=d.prototype;f._init=function(){var c=vec3.create(),d=vec3.create();vec3.sub(c,this._vertexB,this._vertexA);vec3.sub(d,this._vertexC,this._vertexA);this._faceNormal=vec3.create();vec3.cross(this._faceNormal,c,d);vec3.normalize(this._faceNormal,this._faceNormal)};f.contains=function(d){c(d,this._vertexA)||c(d,this._vertexB)||c(d,this._vertexC);return c(d,this._vertexA)||c(d,this._vertexB)||c(d,this._vertexC)};
f.__defineGetter__("faceNormal",function(){return this._faceNormal});var c=function(c,d){return c[0]===d[0]&&c[1]===d[1]&&c[2]===d[2]};bongiovi.Face=d})();(function(){var d=function(c,d,g){this.gl=bongiovi.GLTool.gl;this.vertexSize=c;this.indexSize=d;this.drawType=g;this.extraAttributes=[];this._floatArrayVertex=this.vBufferPos=void 0;this._init()},f=d.prototype;f._init=function(){};f.bufferVertex=function(c,d){var g=[],f=d?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW;this._vertices=[];for(var l=0;l<c.length;l++){for(var s=0;s<c[l].length;s++)g.push(c[l][s]);this._vertices.push(vec3.clone(c[l]))}void 0==this.vBufferPos&&(this.vBufferPos=this.gl.createBuffer());
this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferPos);if(void 0==this._floatArrayVertex)this._floatArrayVertex=new Float32Array(g);else if(c.length!=this._floatArrayVertex.length)this._floatArrayVertex=new Float32Array(g);else for(l=0;l<c.length;l++)this._floatArrayVertex[l]=c[l];this.gl.bufferData(this.gl.ARRAY_BUFFER,this._floatArrayVertex,f);this.vBufferPos.itemSize=3};f.bufferTexCoords=function(c){for(var d=[],g=0;g<c.length;g++)for(var f=0;f<c[g].length;f++)d.push(c[g][f]);this.vBufferUV=
this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferUV);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(d),this.gl.STATIC_DRAW);this.vBufferUV.itemSize=2};f.bufferData=function(c,d,g,f){var l=-1;f=f?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW;for(var s=0;s<this.extraAttributes.length;s++)if(this.extraAttributes[s].name==d){this.extraAttributes[s].data=c;l=s;break}for(var p=[],s=0;s<c.length;s++)for(var m=0;m<c[s].length;m++)p.push(c[s][m]);if(-1==l)s=this.gl.createBuffer(),
this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),l=new Float32Array(p),this.gl.bufferData(this.gl.ARRAY_BUFFER,l,f),this.extraAttributes.push({name:d,data:c,itemSize:g,buffer:s,floatArray:l});else{s=this.extraAttributes[l].buffer;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s);l=this.extraAttributes[l].floatArray;for(s=0;s<p.length;s++)l[s]=p[s];this.gl.bufferData(this.gl.ARRAY_BUFFER,l,f)}};f.bufferIndices=function(c){this._indices=c;this.iBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,
this.iBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(c),this.gl.STATIC_DRAW);this.iBuffer.itemSize=1;this.iBuffer.numItems=c.length};f.computeNormals=function(){if(this.drawType==this.gl.TRIANGLES){void 0===this._faces&&this._generateFaces();console.log("Start computing");var c=(new Date).getTime();this._normals=[];for(var d=0;d<this._vertices.length;d++){var g=vec3.create(),f=0;for(j=0;j<this._faces.length;j++)this._faces[j].contains(this._vertices[d])&&(vec3.add(g,g,this._faces[j].faceNormal),
f++);vec3.normalize(g,g);this._normals.push(g)}this.bufferData(this._normals,"aNormal",3);c=(new Date).getTime()-c;console.log("Total Time : ",c)}};f.computeTangent=function(){};f._generateFaces=function(){this._faces=[];for(var c=0;c<this._indices.length;c+=3)this._faces.push(new bongiovi.Face(this._vertices[this._indices[c+0]],this._vertices[this._indices[c+1]],this._vertices[this._indices[c+2]]))};bongiovi.Mesh=d})();(function(){var d=function(){};d.shaders={};d.shaders.copyVert="precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vTextureCoord;void main(void) {    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);    vTextureCoord = aTextureCoord;}";d.shaders.generalVert="precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;uniform vec3 position;uniform vec3 scale;varying vec2 vTextureCoord;void main(void) {    vec3 pos = aVertexPosition;    pos *= scale;    pos += position;    gl_Position = uPMatrix * uMVMatrix * vec4(pos, 1.0);    vTextureCoord = aTextureCoord;}";
d.shaders.copyFrag="precision highp float;varying vec2 vTextureCoord;uniform sampler2D texture;void main(void) {    gl_FragColor = texture2D(texture, vTextureCoord);}";d.shaders.alphaFrag="precision highp float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform float opacity;void main(void) {    gl_FragColor = texture2D(texture, vTextureCoord);    gl_FragColor.a *= opacity;}";d.shaders.simpleColorFrag="precision highp float;uniform vec3 color;uniform float opacity;void main(void) {    gl_FragColor = vec4(color, opacity);}";
d.shaders.depthFrag="precision highp float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform float n;uniform float f;float getDepth(float z) {\treturn (6.0 * n) / (f + n - z*(f-n));}void main(void) {    float r = texture2D(texture, vTextureCoord).r;    float grey = getDepth(r);    gl_FragColor = vec4(grey, grey, grey, 1.0);}";d.getShader=function(d){return this.shaders[d]};d.get=d.getShader;bongiovi.ShaderLibs=d})();(function(){var d=function(c,d){this.gl=bongiovi.GL.gl;this.idVertex=c;this.idFragment=d;this.parameters=[];this.uniformTextures=[];this.fragmentShader=this.vertexShader=void 0;this._isReady=!1;this._loadedCount=0;void 0==c&&this.createVertexShaderProgram(bongiovi.ShaderLibs.getShader("copyVert"));void 0==d&&this.createFragmentShaderProgram(bongiovi.ShaderLibs.getShader("copyFrag"));this.init()},f=d.prototype;f.init=function(){this.idVertex&&-1<this.idVertex.indexOf("main(void)")?this.createVertexShaderProgram(this.idVertex):
this.getShader(this.idVertex,!0);this.idFragment&&-1<this.idFragment.indexOf("main(void)")?this.createFragmentShaderProgram(this.idFragment):this.getShader(this.idFragment,!1)};f.getShader=function(c,d){if(c){var g=new XMLHttpRequest;g.hasCompleted=!1;var f=this;g.onreadystatechange=function(c){4==c.target.readyState&&(d?f.createVertexShaderProgram(c.target.responseText):f.createFragmentShaderProgram(c.target.responseText))};g.open("GET",c,!0);g.send(null)}};f.createVertexShaderProgram=function(c){if(this.gl){var d=
this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(d,c);this.gl.compileShader(d);if(!this.gl.getShaderParameter(d,this.gl.COMPILE_STATUS))return console.warn("Error in Vertex Shader : ",this.idVertex,":",this.gl.getShaderInfoLog(d)),console.log(c),null;this.vertexShader=d;void 0!=this.vertexShader&&void 0!=this.fragmentShader&&this.attachShaderProgram();this._loadedCount++}};f.createFragmentShaderProgram=function(c){if(this.gl){var d=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(d,
c);this.gl.compileShader(d);if(!this.gl.getShaderParameter(d,this.gl.COMPILE_STATUS))return console.warn("Error in Fragment Shader: ",this.idFragment,":",this.gl.getShaderInfoLog(d)),console.log(c),null;this.fragmentShader=d;void 0!=this.vertexShader&&void 0!=this.fragmentShader&&this.attachShaderProgram();this._loadedCount++}};f.attachShaderProgram=function(){this._isReady=!0;this.shaderProgram=this.gl.createProgram();this.gl.attachShader(this.shaderProgram,this.vertexShader);this.gl.attachShader(this.shaderProgram,
this.fragmentShader);this.gl.linkProgram(this.shaderProgram)};f.bind=function(){this._isReady&&(this.gl.useProgram(this.shaderProgram),void 0==this.shaderProgram.pMatrixUniform&&(this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uPMatrix")),void 0==this.shaderProgram.mvMatrixUniform&&(this.shaderProgram.mvMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uMVMatrix")),bongiovi.GLTool.setShader(this),bongiovi.GLTool.setShaderProgram(this.shaderProgram),this.uniformTextures=
[])};f.isReady=function(){return this._isReady};f.uniform=function(c,d,g){if(this._isReady){"texture"==d&&(d="uniform1i");for(var f=!1,l,s=0;s<this.parameters.length;s++)if(l=this.parameters[s],l.name==c){l.value=g;f=!0;break}f?this.shaderProgram[c]=l.uniformLoc:(this.shaderProgram[c]=this.gl.getUniformLocation(this.shaderProgram,c),this.parameters.push({name:c,type:d,value:g,uniformLoc:this.shaderProgram[c]}));if(-1==d.indexOf("Matrix"))this.gl[d](this.shaderProgram[c],g);else this.gl[d](this.shaderProgram[c],
!1,g);"uniform1i"==d&&(this.uniformTextures[g]=this.shaderProgram[c])}};f.unbind=function(){};bongiovi.GLShader=d})();(function(){var d,f,c=function(c,h,l){l=l||{};d=bongiovi.GL.gl;f=bongiovi.GL;if(h)this.texture=c;else{this._source=c;this.texture=d.createTexture();this._isVideo="VIDEO"==c.tagName;this.magFilter=l.magFilter||d.LINEAR;this.minFilter=l.minFilter||d.LINEAR_MIPMAP_NEAREST;this.wrapS=l.wrapS||d.MIRRORED_REPEAT;this.wrapT=l.wrapT||d.MIRRORED_REPEAT;if(c.width||c.videoWidth){if(h=c.width||c.videoWidth,l=c.height||c.videoHeight,!h||!l||0==h||h&h-1||0==l||l&l-1)this.wrapS=this.wrapT=d.CLAMP_TO_EDGE,this.minFilter==
d.LINEAR_MIPMAP_NEAREST&&(this.minFilter=d.LINEAR)}else this.wrapS=this.wrapT=d.CLAMP_TO_EDGE,this.minFilter==d.LINEAR_MIPMAP_NEAREST&&(this.minFilter=d.LINEAR);d.bindTexture(d.TEXTURE_2D,this.texture);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,c);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,this.magFilter);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.minFilter);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,this.wrapS);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_WRAP_T,this.wrapT);this.minFilter==d.LINEAR_MIPMAP_NEAREST&&d.generateMipmap(d.TEXTURE_2D);d.bindTexture(d.TEXTURE_2D,null)}},h=c.prototype;h.updateTexture=function(c){c&&(this._source=c);d.bindTexture(d.TEXTURE_2D,this.texture);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!0);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,this._source);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,this.magFilter);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.minFilter);this.minFilter==d.LINEAR_MIPMAP_NEAREST&&
d.generateMipmap(d.TEXTURE_2D);d.bindTexture(d.TEXTURE_2D,null)};h.bind=function(c,h){void 0==c&&(c=0);f.shader&&(d.activeTexture(d.TEXTURE0+c),d.bindTexture(d.TEXTURE_2D,this.texture),d.uniform1i(f.shader.uniformTextures[c],c),this._bindIndex=c)};h.unbind=function(){d.bindTexture(d.TEXTURE_2D,null)};bongiovi.GLTexture=c})();(function(){var d=function(c,d){this.shader=new bongiovi.GLShader(c,d);this._init()},f=d.prototype;f._init=function(){};f.render=function(){};bongiovi.View=d})();(function(){var d=bongiovi.View,f=function(c,f){d.call(this,c,f)},c=f.prototype=new d;c._init=function(){this.mesh=bongiovi.MeshUtils.createPlane(2,2,1)};c.render=function(c){this.shader.isReady()&&(this.shader.bind(),this.shader.uniform("texture","uniform1i",0),c.bind(0),bongiovi.GLTool.draw(this.mesh))};bongiovi.ViewCopy=f})();(function(){var d=bongiovi.GL,f=function(c,d){this._near=c||0;this._far=d||0;bongiovi.View.call(this,null,bongiovi.ShaderLibs.getShader("depthFrag"))},c=f.prototype=new bongiovi.View;c._init=function(){this.mesh=bongiovi.MeshUtils.createPlane(2,2,1)};c.render=function(c,f){f&&(this._near=f.near,this._far=f.far);this.shader.bind();this.shader.uniform("texture","uniform1i",0);this.shader.uniform("n","uniform1f",this._near);this.shader.uniform("f","uniform1f",this._far);c.bind(0);d.draw(this.mesh)};
bongiovi.ViewDepth=f})();(function(){var d,f,c=bongiovi.GLTexture,h=function(c,g,h){f=bongiovi.GL;d=f.gl;h=h||{};this.width=c;this.height=g;this.magFilter=h.magFilter||d.LINEAR;this.minFilter=h.minFilter||d.LINEAR;this.wrapS=h.wrapS||d.MIRRORED_REPEAT;this.wrapT=h.wrapT||d.MIRRORED_REPEAT;if(0==c||c&c-1||0==g||g&g-1)this.wrapS=this.wrapT=d.CLAMP_TO_EDGE,this.minFilter==d.LINEAR_MIPMAP_NEAREST&&(this.minFilter=d.LINEAR);this._init()},g=h.prototype;g._init=function(){this.texture=d.createTexture();this.glTexture=new c(this.texture,
!0);this.frameBuffer=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,this.frameBuffer);this.frameBuffer.width=this.width;this.frameBuffer.height=this.height;d.bindTexture(d.TEXTURE_2D,this.texture);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,this.magFilter);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.minFilter);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);f.depthTextureExt?d.texImage2D(d.TEXTURE_2D,
0,d.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,d.RGBA,d.FLOAT,null):d.texImage2D(d.TEXTURE_2D,0,d.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,d.RGBA,d.UNSIGNED_BYTE,null);this.minFilter==d.LINEAR_MIPMAP_NEAREST&&d.generateMipmap(d.TEXTURE_2D);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this.texture,0);if(null==f.depthTextureExt){var g=d.createRenderbuffer();d.bindRenderbuffer(d.RENDERBUFFER,g);d.renderbufferStorage(d.RENDERBUFFER,d.RGBA4,this.frameBuffer.width,
this.frameBuffer.height)}else this.depthTexture=d.createTexture(),this.glDepthTexture=new c(this.depthTexture,!0),d.bindTexture(d.TEXTURE_2D,this.depthTexture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.texImage2D(d.TEXTURE_2D,0,d.DEPTH_COMPONENT,this.width,this.height,0,d.DEPTH_COMPONENT,d.UNSIGNED_SHORT,
null),d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.TEXTURE_2D,this.depthTexture,0);d.bindTexture(d.TEXTURE_2D,null);d.bindRenderbuffer(d.RENDERBUFFER,null);d.bindFramebuffer(d.FRAMEBUFFER,null)};g.bind=function(){d.bindFramebuffer(d.FRAMEBUFFER,this.frameBuffer)};g.unbind=function(){d.bindFramebuffer(d.FRAMEBUFFER,null)};g.getTexture=function(){return this.glTexture};g.getDepthTexture=function(){return this.glDepthTexture};bongiovi.FrameBuffer=h})();(function(){var d,f=function(c,f,n){d=bongiovi.GL;void 0!=c&&(this.view="string"==typeof c?new bongiovi.ViewCopy(null,c):c,this.width=void 0==f?512:f,this.height=void 0==n?512:n,this._init())},c=f.prototype;c._init=function(){this.fbo=new bongiovi.FrameBuffer(this.width,this.height);this.fbo.bind();d.setViewport(0,0,this.fbo.width,this.fbo.height);d.clear(0,0,0,0);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height)};c.render=function(c){this.fbo.bind();d.setViewport(0,0,this.fbo.width,
this.fbo.height);d.clear(0,0,0,0);this.view.render(c);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height);return this.fbo.getTexture()};c.getTexture=function(){return this.fbo.getTexture()};bongiovi.Pass=f})();(function(d){d=function(){this._passes=[]};var f=d.prototype=new bongiovi.Pass;f.addPass=function(c){this._passes.push(c)};f.render=function(c){this.texture=c;for(c=0;c<this._passes.length;c++)this.texture=this._passes[c].render(this.texture);return this.texture};f.getTexture=function(){return this.texture};bongiovi.EffectComposer=d})();(function(){bongiovi.MeshUtils={};bongiovi.MeshUtils.createPlane=function(d,f,c){var h=[],g=[],n=[],l=d/c,s=f/c,p=1/c,m=0;d=0.5*-d;f=0.5*-f;for(var q=0;q<c;q++)for(var w=0;w<c;w++){var u=l*q+d,r=s*w+f;h.push([u,r,0]);h.push([u+l,r,0]);h.push([u+l,r+s,0]);h.push([u,r+s,0]);u=q/c;r=w/c;g.push([u,r]);g.push([u+p,r]);g.push([u+p,r+p]);g.push([u,r+p]);n.push(4*m+0);n.push(4*m+1);n.push(4*m+2);n.push(4*m+0);n.push(4*m+2);n.push(4*m+3);m++}c=new bongiovi.Mesh(h.length,n.length,bongiovi.GLTool.gl.TRIANGLES);
c.bufferVertex(h);c.bufferTexCoords(g);c.bufferIndices(n);return c};bongiovi.MeshUtils.createSphere=function(d,f){for(var c=[],h=[],g=[],n=0,l=1/f,s=function(c,g){var a=c/f*Math.PI-0.5*Math.PI,b=g/f*Math.PI*2,e=[];e[1]=Math.sin(a)*d;a=Math.cos(a)*d;e[0]=Math.cos(b)*a;e[2]=Math.sin(b)*a;e[0]=Math.floor(1E4*e[0])/1E4;e[1]=Math.floor(1E4*e[1])/1E4;e[2]=Math.floor(1E4*e[2])/1E4;return e},p=0;p<f;p++)for(var m=0;m<f;m++){c.push(s(p,m));c.push(s(p+1,m));c.push(s(p+1,m+1));c.push(s(p,m+1));var q=m/f,w=p/
f;h.push([1-q,w]);h.push([1-q,w+l]);h.push([1-q-l,w+l]);h.push([1-q-l,w]);g.push(4*n+0);g.push(4*n+1);g.push(4*n+2);g.push(4*n+0);g.push(4*n+2);g.push(4*n+3);n++}n=new bongiovi.Mesh(c.length,g.length,bongiovi.GLTool.gl.TRIANGLES);n.bufferVertex(c);n.bufferTexCoords(h);n.bufferIndices(g);return n};bongiovi.MeshUtils.createCube=function(d,f){}})();(function(){var d=bongiovi.GL,f=function(c,d,f){this.value=c;void 0==c&&(this.value=0);bongiovi.Pass.call(this,"precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform float brightness;void main(void) {\tvec4 color = texture2D(texture, vTextureCoord);\tcolor.rgb += vec3(brightness);\tgl_FragColor = color;}",d,f)};(f.prototype=new bongiovi.Pass).render=function(c){this.fbo.bind();d.setViewport(0,0,this.fbo.width,this.fbo.height);d.clear(0,0,0,0);this.view.shader.bind();
this.view.shader.uniform("brightness","uniform1f",this.value);this.view.render(c);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height);return this.fbo.getTexture()};void 0==bongiovi.post&&(bongiovi.post={});bongiovi.post.PassBrightness=f})();(function(){var d=bongiovi.GL,f=function(c,d,f){this.value=c;void 0==c&&(this.value=1);bongiovi.Pass.call(this,"precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform float contrast;float _contrast(float value, float scale) {\treturn clamp( .5 + (value - .5) * scale, 0.0, 1.0);}vec3 _contrast(vec3 value, float scale) {\treturn vec3(_contrast(value.r, scale), _contrast(value.g, scale), _contrast(value.b, scale) );}void main(void) {\tvec4 color = texture2D(texture, vTextureCoord);\tcolor.rgb = _contrast(color.rgb, contrast);\tgl_FragColor = color;}",
d,f)};(f.prototype=new bongiovi.Pass).render=function(c){this.fbo.bind();d.setViewport(0,0,this.fbo.width,this.fbo.height);d.clear(0,0,0,0);this.view.shader.bind();this.view.shader.uniform("contrast","uniform1f",this.value);this.view.render(c);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height);return this.fbo.getTexture()};void 0==bongiovi.post&&(bongiovi.post={});bongiovi.post.PassContrast=f})();(function(){var d=bongiovi.GL,f=function(c,d,f){this.value=c;void 0==c&&(this.value=0);bongiovi.Pass.call(this,"precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform float greyscale;void main(void) {\tvec4 color = texture2D(texture, vTextureCoord);\tfloat grey = dot(color.rgb, vec3(0.299, 0.587, 0.114));\tcolor.rgb = mix(vec3(grey), color.rgb, 1.0-greyscale);\tgl_FragColor = color;}",d,f)};(f.prototype=new bongiovi.Pass).render=function(c){this.fbo.bind();d.setViewport(0,
0,this.fbo.width,this.fbo.height);d.clear(0,0,0,0);this.view.shader.bind();this.view.shader.uniform("greyscale","uniform1f",this.value);this.view.render(c);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height);return this.fbo.getTexture()};void 0==bongiovi.post&&(bongiovi.post={});bongiovi.post.PassGreyscale=f})();(function(){var d=bongiovi.GL,f=function(c,d,f){this.value=c;void 0==c&&(this.value=0);bongiovi.Pass.call(this,"precision mediump float;varying vec2 vTextureCoord;uniform sampler2D texture;uniform vec2 delta;float random(vec3 scale, float seed) {\treturn fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);}void main(void) {\tvec4 color = vec4(0.0);\tfloat total = 0.0;\tfloat offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\tfor (float t = -30.0; t <= 30.0; t++) {\t\tfloat percent = (t + offset - 0.5) / 30.0;\t\tfloat weight = 1.0 - abs(percent);\t\tvec4 sample = texture2D(texture, vTextureCoord + delta * percent);\t\t\t\tsample.rgb *= sample.a;\t\tcolor += sample * weight;\t\ttotal += weight;\t}\tgl_FragColor = color/total;\tgl_FragColor.rgb /= gl_FragColor.a + .00001;}",
d,f)};(f.prototype=new bongiovi.Pass).render=function(c){this.fbo.bind();d.setViewport(0,0,this.fbo.width,this.fbo.height);d.clear(0,0,0,0);this.view.shader.bind();this.view.shader.uniform("delta","uniform2fv",this.value);this.view.render(c);this.fbo.unbind();d.setViewport(0,0,d.canvas.width,d.canvas.height);return this.fbo.getTexture()};void 0==bongiovi.post&&(bongiovi.post={});bongiovi.post.PassTriangleBlurSingle=f})();
(function(){var d=bongiovi.GL,f=function(c,d,f){this.value=c;this._width=d;this._height=f;void 0==c&&(this.value=0);bongiovi.EffectComposer.call(this);this._init()},c=f.prototype=new bongiovi.EffectComposer,h=bongiovi.EffectComposer.prototype;c._init=function(){this._passVertical=new bongiovi.post.PassTriangleBlurSingle([0,this.value/d.canvas.height],this._width,this._height);this._passHorizontal=new bongiovi.post.PassTriangleBlurSingle([this.value/d.canvas.width,0],this._width,this._height);this.addPass(this._passVertical);
this.addPass(this._passHorizontal)};c.render=function(c){this._passVertical.value=[0,this.value/d.canvas.height];this._passHorizontal.value=[this.value/d.canvas.width,0];return h.render.call(this,c)};void 0==bongiovi.post&&(bongiovi.post={});bongiovi.post.PassTriangleBlur=f})();
